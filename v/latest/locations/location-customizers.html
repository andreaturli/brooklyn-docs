<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Location Customizers - Apache Brooklyn</title>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/octicons/octicons.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/bootstrap-theme.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/font-awesome-4.2.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/tooltip.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/css/code.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/css/website.css" rel="stylesheet" />

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body class="page">
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
                <a class="brand-apache" href="http://www.apache.org/">
                    <img src="https://www.apache.org/foundation/press/kit/feather.svg" alt="[Apache]">
                </a>
                
                <a class="brand-brooklyn" href="/brooklyn-docs/"><img src="/brooklyn-docs/style/img/apache-brooklyn-logo-244px-wide.png" alt="brooklyn"></a>
                
            </div>
        </div>
        <div class="collapse navbar-collapse" id="main-menu">


            <ul class="nav navbar-nav navbar-right">
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/learnmore/index.html" data-toggle="dropdown">learn more <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/learnmore/index.html">Learn More</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/blueprint-tour.html">Blueprint Tour
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/features/index.html">Features
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/theory.html">Theory
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/catalog/index.html">Browse Catalog
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/v/latest/start/index.html" data-toggle="dropdown">get started <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/v/latest/start/index.html">Get Started</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/running.html">Running Apache Brooklyn
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/blueprints.html">Deploying Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/managing.html">Monitoring and Managing Applications
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/policies.html">Policies
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/concept-quickstart.html">Brooklyn Concepts Quickstart
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/documentation/index.html" data-toggle="dropdown">documentation <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/documentation/index.html">Documentation</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li class="section">
                            <a href="/brooklyn-docs/v/latest/index.html">User Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/blueprints/creating-yaml.html">Writing Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/locations/index.html">Deploying Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li class="section">
                            <a href="/brooklyn-docs/v/latest/ops/index.html">Reference Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/dev/index.html">Developer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        <li class="divider"></li>
                        <li >
                            <a href="/brooklyn-docs/meta/versions.html">Versions
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/documentation/other-docs.html">Other Resources
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/community/index.html" data-toggle="dropdown">community <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/community/index.html">Community</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/mailing-lists.html">Mailing Lists
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/irc.html">IRC
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/security/index.html">Security Advisories
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="https://issues.apache.org/jira/browse/BROOKLYN">Bug Tracker (JIRA)
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/how-to-contribute-docs.html">Contributing Documentation
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/developers/index.html" data-toggle="dropdown">developers <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/developers/index.html">Developers</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/code/index.html">Get the Code
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/how-to-contribute.html">How to Contribute
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/dev/index.html">Developer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/committers/index.html">Committer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/code-standards.html">Code Standards
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/links.html">Handy Places
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="http://github.com/apache/brooklyn">GitHub
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="https://issues.apache.org/jira/browse/BROOKLYN">Bug Tracker (JIRA)
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <form class="navbar-form">
                        <a href="/brooklyn-docs/download/index.html" class="btn btn-default">download</a>
                    </form>
                    
                </li>
                
            </ul>
        </div>
    </div>
</nav>


<main>
    <div class="container">
        <div class="row">
            <div class="col-md-9 content">
                <div id="page_notes"></div>
                <h1>Location Customizers</h1>
                <p>Apache Brooklyn supports a number of ways to configure and customize locations. These include
the <code>JcloudsLocationCustomizer</code>, which is for advanced customization of VM provisioning through jclouds.
There is also a <code>MachineLocationCustomizer</code>, which allows customization of machines being obtained 
from any kind of location (including <a href="index.html#byon">Bring Your Own Nodes</a>).</p>

<h2 id="usage-guidelines">Usage Guidelines</h2>

<p>Clearly there is an overlap for where things can be done. This section describes the recommended<br />
separation of responsibilities.</p>

<p>These are guidelines only - users are obviously free to make alternative usage decisions based on 
their particular use-cases.</p>

<h3 id="responsibilities-of-entity-versus-location">Responsibilities of Entity versus Location</h3>

<p>From an entity’s perspective, it calls <code>location.obtain(options)</code> and gets back a usable 
<code>MachineLocation</code> that has a standard base operating system that gives remote access
(e.g. for Linux it expects credentials for a user with <code>sudo</code> rights, and ssh access).</p>

<p>However, there are special cases - for example the <code>location.obtain(options)</code> could return
a Docker container with the software pre-installed, and no remote access (see the 
<a href="http://clocker.io">Clocker project</a> for more information on use of Docker with Brooklyn).</p>

<p>The entity is then responsible for configuring that machine according to the needs of the software 
to be installed.</p>

<p>For example, the entity may install software packages, upload/update configuration files, launch
processes, etc.</p>

<p>The entity may also configure <code>iptables</code>. This is also possible through the <code>JcloudsLocation</code> 
configuration. However, it is preferable to do this in the entity because it is part of 
configuring the machine in the way required for the given software component.</p>

<p>The entity may also perform custom OS setup, such as installing security patches. However, whether 
this is appropriate depends on the nature of the security patch: if the security patch is specific 
to the entity type, then it should be done within the entity; but if it is to harden the base OS 
to make it comply with an organisation’s standards (e.g. to overcome shortcomings of the base 
image, or to install security patches) then a <code>MachineLocationCustomizer</code> is more appropriate.</p>

<h3 id="location-configuration-options">Location Configuration Options</h3>

<p>This refers to standard location configuration: explicit config keys, and explicit jclouds template 
configuration that can be passed through.</p>

<p>This kind of configuration is simplest to use. It is the favoured mechanism when it comes to VM 
provisioning, and should be used wherever possible.</p>

<p>Note that a jclouds <code>TemplateBuilder</code> and cloud-specific <code>TemplateOptions</code> are the generic mechanisms 
within jclouds for specifying the details of the compute resource to be provisioned.</p>

<h3 id="jclouds-location-customizer">Jclouds Location Customizer</h3>
<p>A <code>JcloudsLocationCustomizer</code> has customization hooks to execute code at the various points of building 
up the jclouds template and provisioning the machine. Where jclouds is being used and where the required 
use of jclouds goes beyond simple configuration, this is an appropriate solution.</p>

<p>For example, there is a <code>org.apache.brooklyn.location.jclouds.networking.JcloudsLocationSecurityGroupCustomizer</code>
which gives more advanced support for setting up security groups (e.g. in AWS-EC2).</p>

<h3 id="machine-customizer">Machine Customizer</h3>

<p>The <code>MachineLocationCustomizer</code> allows customization of machines being obtained from any kind of location.
For example, this includes for jclouds and for Bring Your Own Nodes (BYON).</p>

<p>It provides customization hooks for when the machine has been provisioned (before it is returned by the location)
and when the machine is about to be released by the location.</p>

<p>An example use would be to register (and de-register) the machine in a CMDB.</p>

<h2 id="jclouds-location-customizers">Jclouds Location Customizers</h2>

<p><em>Warning: additional methods (i.e. customization hooks) may be added to the <code>JcloudsLocationCustomizer</code> 
interface in future releases. Users are therefore strongly encouraged to sub-class 
<code>BasicJcloudsLocationCustomizer</code>, rather than implementing JcloudsLocationCustomizer directly.</em></p>

<p>The <code>JcloudsLocationCustomizer</code> provides customization hooks at various points of the Brooklyn’s
use of jclouds. These can be used to adjust the configuration, to do additional setup, to do
custom logging, etc.</p>

<ul>
  <li>
    <p>Customize the <code>org.jclouds.compute.domain.TemplateBuilder</code>, before it is used to build the template.
This is used to influence the choice of VM image, hardware profile, etc. This hook is not normally
required as the location configuration options can be used in instead.</p>
  </li>
  <li>
    <p>Customize the <code>org.jclouds.compute.domain.Template</code>, to be used when creating the machine. This<br />
hook is most often used for performing custom actions - for example to create or modify a security 
group or volume, and to update the template’s options to use that.</p>
  </li>
  <li>
    <p>Customize the <code>org.jclouds.compute.options.TemplateOptions</code> to be used when creating the machine.
The <code>TemplateOptions</code> could be cast to a cloud-specific sub-type (if this does not have to work
across different clouds). Where the use-case is to just set simple configuration on the 
<code>TemplateOptions</code>, consider instead using the config key <code>templateOptions</code>, which takes a map
of type String to Object - the strings should match the method names in the <code>TemplateOptions</code>.</p>
  </li>
  <li>
    <p>Customize the <code>org.apache.brooklyn.location.jclouds.JcloudsMachineLocation</code> that has been 
created. For Linux-based VMs, if the config <code>waitForSshable</code> was not false, then this machine
is guaranteed to be ssh’able. Similarly for WinRM access to Windows machines, if 
<code>waitForWinRmAvailable</code> was not false.</p>
  </li>
  <li>
    <p>Pre-release of the machine. If the actions required are specific to jclouds (e.g. using jclouds 
to make calls to the cloud provider) then this should be used; otherwise one should use the more
generic <code>MachineLocationCustomizer</code>.</p>
  </li>
  <li>
    <p>Post-release of the machine (i.e. after asking jclouds to destroying the machine).</p>
  </li>
</ul>

<p>To register a <code>JcloudsLocationCustomizer</code> in YAML, the config key <code>customizers</code> can be used to 
provide a list of instances. Each instance can be defined using <code>$brooklyn:object</code> to indicate 
the type and its configuration. For example:</p>

<pre><code>location:
  jclouds:aws-ec2:us-east-1:
    customizers:
    - $brooklyn:object:
        type: com.acme.brooklyn.MyJcloudsLocationCustomizer
</code></pre>

<p>To register <code>JcloudsLocationCustomizer</code> instances programmatically, set the config key
<code>JcloudsLocationConfig.JCLOUDS_LOCATION_CUSTOMIZERS</code> on the location, or pass this 
config option when calling <code>location.obtain(options)</code>.</p>

<p>The <code>SharedLocationSecurityGroupCustomizer</code> configures a shared security group on Jclouds locations.
It only works on AWS and Azure ARM.</p>

<p>To register a <code>SharedLocationSecurityGroupCustomizer</code> in YAML, you can use the config key <code>customizers</code>
and configure it with <code>$brooklyn:object</code> and <code>object.fields</code>. For example:</p>

<pre><code>location:
  jclouds:aws-ec2:us-east-1:
    customizers:
    - $brooklyn:object:
        type: org.apache.brooklyn.location.jclouds.networking.SharedLocationSecurityGroupCustomizer
        object.fields: {locationName: "myloc", tcpPortRanges: ["22", "8080", "9443"], udpPortRanges: ["2001", "4013"], cidr: "82.40.153.101/24"}
</code></pre>

<p>where <code>cidr</code> can be optionally set to restrict the range that the ports that are to be opened can be accessed from.</p>

<h2 id="machine-location-customizers">Machine Location Customizers</h2>

<p><em>Warning: additional methods (i.e. customization hooks) may be added to the <code>MachineLocationCustomizer</code> 
interface in future releases. Users are therefore strongly encouraged to sub-class 
<code>BasicMachineLocationCustomizer</code>, rather than implementing <code>MachineLocationCustomizer</code> directly.</em></p>

<p>The <code>MachineLocationCustomizer</code> provides customization hooks for when a machine is obtained/released 
from a <code>MachineProvisioningLocation</code>. The following hooks are supported: </p>

<ul>
  <li>
    <p>After the machine has been provisioned/allocated, but before it has been returned.</p>
  </li>
  <li>
    <p>When the machine is about to be released, but prior to actually destroying/unallocating the
machine.</p>
  </li>
</ul>

<p>To register a <code>MachineLocationCustomizer</code> in YAML, the config key <code>machineCustomizers</code> can be used<br />
to provide a list of instances. Each instance can be defined using <code>$brooklyn:object</code> to indicate 
the type and its configuration. For example:</p>

<pre><code>location:
  jclouds:aws-ec2:us-east-1:
    machineCustomizers:
    - $brooklyn:object:
        type: com.acme.brooklyn.MyMachineLocationCustomizer
</code></pre>

<p>To register <code>MachineLocationCustomizer</code> instances programmatically, set the config key
<code>CloudLocationConfig.MACHINE_LOCATION_CUSTOMIZERS</code> on the location, or pass this 
config option when calling <code>location.obtain(options)</code>.</p>

            </div>

            <aside class="col-md-3">
                <div class="list-group side-menu" id="side-menu">



  
     
              
                  <h4 class="">
                    <a href="/brooklyn-docs/v/latest/locations/index.html" class="list-group-item breadcrumb breadcrumb0">
                      Locations
                      </a></h4>
              
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#clouds" class="list-group-item">Clouds
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#amazon-web-services-aws" class="list-group-item">Amazon Web Services
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#azure-compute-arm" class="list-group-item">Azure Compute ARM
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#azure-compute-classic" class="list-group-item">Azure Compute Classic
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#cloudstack" class="list-group-item">Apache CloudStack
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#google-compute-engine-gce" class="list-group-item">Google Compute Engine
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#ibm-softlayer" class="list-group-item">IBM Softlayer
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#inheritance-and-named-locations" class="list-group-item">Named Locations
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#openstack" class="list-group-item">OpenStack
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/location-customizers.html" class="list-group-item active">Location Customizers
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#byon" class="list-group-item">BYON
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#ssh-keys" class="list-group-item">SSH Keys
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#localhost" class="list-group-item">Localhost
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/locations/index.html#specialized-locations" class="list-group-item">Specialized Locations
                    </a>
                
              
        
        
  

        
</div>
<div id="width_reference"></div>


<script language="JavaScript" type="application/javascript">
(function($){
    
    sidemenu_x_sizer=function(){ $('#side-menu').width($('#side-menu').parent().find('#width_reference').outerWidth()); };
    $(sidemenu_x_sizer);
    $(window).resize(sidemenu_x_sizer);

    
    sidemenu_y_nonfloater=function(){
      if ($('#side-menu').outerHeight(true) + $('#header').outerHeight(true) + $('#footer').outerHeight(true) > window.innerHeight ||
          $('#side-menu').width() >= $('#content_container').width()/2) {
        $('#side-menu').css('position', 'inherit');
      } else {
        // restore if screen has grown
        $('#side-menu').css('position', 'fixed');
      }
    };
    $(sidemenu_y_nonfloater);
    $(window).resize(sidemenu_y_nonfloater);

    

    var sideMenu = $("#side-menu"),
        sideItems = sideMenu.find("a"),
        // Anchors corresponding to menu items
        scrollItems = sideItems.map(function(){
          var item = $(this).attr("section-target");
          if (item && item.length) { return item; }
        });

    var highlight_section_last_top = -1;
    var highlight_section_completed = false;

    var highlight_section = function() {
       // Get container scroll position
       var highlight_section_new_top = $(this).scrollTop();
       if (highlight_section_new_top == highlight_section_last_top) return;
       var highlight_section_new_bottom = highlight_section_new_top + $(window).height();
       var scroll_advancing = (highlight_section_new_top > highlight_section_last_top);

       var last_item = null, active_item = $("#side-menu a.section#active");

       var found_top = false;
       var displayable_items = scrollItems.map(function(itemI){
         item = $(scrollItems[itemI]);
         if (item && item.length) {
           if (highlight_section_last_top == -1 || !highlight_section_completed) {
             // just opening page - take item matching hash, or otherwise the first item visible
             if (item.selector === window.location.hash || (item.offset().top > highlight_section_new_top - 20 && !found_top)) {
               found_top = true;
               if (item.selector === window.location.hash && item.offset().top < highlight_section_new_top + 60) {
                 // because of our top header, we need to scroll 64px down from any link
                 $('html, body').animate({scrollTop: item.offset().top - 64}, 0);
               }
               return item;
             }
           } else if (scroll_advancing) {
             // if scrolling advance, pick up a section when title starts before 1/3 height
             if (item.offset().top < highlight_section_new_top + $(window).height()/3)
               return item;

             // or if containing div is finished (usu the whole main content)
             div_containing_item = item.closest("div");
             if (div_containing_item.offset().top + div_containing_item.height() < highlight_section_new_bottom + 15)
               return item;
             // or when next title is visible
             if (last_item && item.offset().top < highlight_section_new_bottom + 15)
               return last_item;
           } else {
             // if scrolling back, pick up a section as soon as the title is visible,
             if (item.offset().top < highlight_section_new_top)
               return item;
             // or if title is before the 2/3 point
             // (not sure about this, probably want also to have
             // "AND the id.top is <= displayable_itemsrent_active_it.top" so we don't jump FORWARD a section
             // when scrolling BACK, with lots of tiny sections)
             if ((item.offset().top < highlight_section_new_top + 2*$(window).height()/3)
                 && (!active_item || !active_item.offset() || active_item.offset().top >= item.offset().top))
               return item;

           }
           last_item = item;
         }
       });
       if (!highlight_section_completed && document.readyState === "complete") {
         highlight_section_completed = true;
       }
       if (!displayable_items.length) {
         $("#side-menu a.section").removeClass("active");
       } else {
         displayable_items = displayable_items[displayable_items.length-1];
         var id = displayable_items && displayable_items.length ? displayable_items[0].id : "";
       // Set/remove active class
         new_active = $("#side-menu a.section").filter("[section-target='#"+id+"']");
         if (new_active.hasClass("active")) {
           // nothing needed
         } else {
           $("#side-menu a.section").removeClass("active");
           $("#side-menu a.section").filter("[section-target='#"+id+"']").addClass("active");
         }
       }

       highlight_section_last_top = highlight_section_new_top;
    };
    var highlight_new_section = function() {
      highlight_section_completed = false;
      highlight_section_last_top = -1;
      highlight_section();
    }

    $(window).scroll(highlight_section);
    $(highlight_new_section);

    // detect link change - courtesy http://www.bennadel.com/blog/1520-binding-events-to-non-dom-objects-with-jquery.htm

    // Default to the current location.
    var strLocation = window.location.href;
    var strHash = window.location.hash;
    var strPrevLocation = "";
    var strPrevHash = "";

    // This is how often we will be checkint for
    // changes on the location.
    var intIntervalTime = 100;

    // This method removes the pound from the hash.
    var fnCleanHash = function( strHash ){
        return(
            strHash.substring( 1, strHash.length )
            );
    }

    // This will be the method that we use to check
    // changes in the window location.
    var fnCheckLocation = function(){
        // Check to see if the location has changed.
        if (strLocation != window.location.href){

            // Store the new and previous locations.
            strPrevLocation = strLocation;
            strPrevHash = strHash;
            strLocation = window.location.href;
            strHash = window.location.hash;

            // The location has changed. Trigger a
            // change event on the location object,
            // passing in the current and previous
            // location values.
            $( window.location ).trigger(
                "change",
                {
                    currentHref: strLocation,
                    currentHash: fnCleanHash( strHash ),
                    previousHref: strPrevLocation,
                    previousHash: fnCleanHash( strPrevHash )
                }
                );

        }
    }

    // Set an interval to check the location changes.
    setInterval( fnCheckLocation, intIntervalTime );

    // and trigger highlight section on link change
    $(window.location).bind("change", highlight_new_section);
})(jQuery);

</script>

            </aside>
        </div>
    </div>
</main>

<footer class="container">
    <div class="row">
        <div class="col-md-9">
            <p>Apache Brooklyn is distributed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License v2.0</a>.</p>
        </div>
        <div class="col-md-3 text-right">
            <p>
                <a class="btn btn-sm btn-default" href="https://github.com/apache/brooklyn-docs/edit/master/guide/locations/location-customizers.md">Edit This Page</a>
                <a href="https://brooklyn.apache.org/community/how-to-contribute-docs.html"
                    data-toggle="tooltip" data-placement="top" title="" data-delay="400" data-original-title="How to Edit Documentation">
                    <span class="octicon octicon-question octicon-footer"></span>
                </a>
            </p>
        </div>
    </div>
</footer>

</body>

<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/deps/jquery.cookie.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/js/zeroclipboard/ZeroClipboard.min.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/deps/tooltip.js"></script>

<script type="text/javascript">
    ZeroClipboard.config({ moviePath: '/style/js/zeroclipboard/ZeroClipboard.swf' });
</script>
<script src="/brooklyn-docs/style/js/public.js"></script>
</html>
