<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Get the Code - Apache Brooklyn</title>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/octicons/octicons.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/bootstrap-theme.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/font-awesome-4.2.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/deps/tooltip.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/css/code.css" rel="stylesheet" />
<link href="/brooklyn-docs/style/css/website.css" rel="stylesheet" />

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body class="page">
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
                <a class="brand-apache" href="http://www.apache.org/">
                    <img src="https://www.apache.org/foundation/press/kit/feather.svg" alt="[Apache]">
                </a>
                
                <a class="brand-brooklyn" href="/brooklyn-docs/"><img src="/brooklyn-docs/style/img/apache-brooklyn-logo-244px-wide.png" alt="brooklyn"></a>
                
            </div>
        </div>
        <div class="collapse navbar-collapse" id="main-menu">


            <ul class="nav navbar-nav navbar-right">
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/learnmore/index.html" data-toggle="dropdown">learn more <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/learnmore/index.html">Learn More</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/blueprint-tour.html">Blueprint Tour
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/features/index.html">Features
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/theory.html">Theory
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/learnmore/catalog/index.html">Browse Catalog
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/v/latest/start/index.html" data-toggle="dropdown">get started <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/v/latest/start/index.html">Get Started</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/running.html">Running Apache Brooklyn
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/blueprints.html">Deploying Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/managing.html">Monitoring and Managing Applications
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/policies.html">Policies
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/start/concept-quickstart.html">Brooklyn Concepts Quickstart
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/documentation/index.html" data-toggle="dropdown">documentation <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/documentation/index.html">Documentation</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li class="section">
                            <a href="/brooklyn-docs/v/latest/index.html">User Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/blueprints/creating-yaml.html">Writing Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/locations/index.html">Deploying Blueprints
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li class="section">
                            <a href="/brooklyn-docs/v/latest/ops/index.html">Reference Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/dev/index.html">Developer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        <li class="divider"></li>
                        <li >
                            <a href="/brooklyn-docs/meta/versions.html">Versions
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/documentation/other-docs.html">Other Resources
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <a href="/brooklyn-docs/community/index.html" data-toggle="dropdown">community <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/community/index.html">Community</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/mailing-lists.html">Mailing Lists
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/irc.html">IRC
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/security/index.html">Security Advisories
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="https://issues.apache.org/jira/browse/BROOKLYN">Bug Tracker (JIRA)
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/community/how-to-contribute-docs.html">Contributing Documentation
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown active">
                    
                    <a href="/brooklyn-docs/developers/index.html" data-toggle="dropdown">developers <span class="caret"></span></a>
                    
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="/brooklyn-docs/developers/index.html">Developers</a>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/code/index.html">Get the Code
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/how-to-contribute.html">How to Contribute
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/v/latest/dev/index.html">Developer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/committers/index.html">Committer Guide
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/code-standards.html">Code Standards
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="/brooklyn-docs/developers/links.html">Handy Places
                                </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="http://github.com/apache/brooklyn">GitHub
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                        
                        <li >
                            <a href="https://issues.apache.org/jira/browse/BROOKLYN">Bug Tracker (JIRA)
                                &nbsp;<span class="octicon octicon-link-external"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li>test 1</li>
                                <li>test 1</li>
                                <li>test 1</li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                    
                    
                </li>
                
                <li class="dropdown">
                    
                    <form class="navbar-form">
                        <a href="/brooklyn-docs/download/index.html" class="btn btn-default">download</a>
                    </form>
                    
                </li>
                
            </ul>
        </div>
    </div>
</nav>


<main>
    <div class="container">
        <div class="row">
            <div class="col-md-9 content">
                <div id="page_notes"></div>
                <h1>Get the Code</h1>
                <h2 id="set-up-forks">Set Up Forks</h2>

<p>If you’re contributing or working a lot on a feature, 
you’ll probably want your own forks and a slightly different git remote setup.</p>

<p>You can create forks of each Brooklyn repo <a href="https://github.com/apache?query=brooklyn">in the GitHub UI</a> 
or, if you have the command-line tool <code>hub</code> (<a href="https://github.com/github/hub">described here</a>, or <code>sudo npm install -g hub</code>),
by running this command:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">hub fork<span class="p">;</span> git submodule foreach <span class="s1">&#39;hub fork&#39;</span></code></pre></div>

<p>The <a href="index.html">Get the Code: Basics</a> page described how to retrieve the upstream repos, 
but it gave those remotes the name <code>origin</code>.
When using forks, <code>upstream</code> is a more accurate name. 
You can rename the origin remotes with:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git remote rename origin upstream<span class="p">;</span> git submodule foreach <span class="s1">&#39;git remote rename origin upstream&#39;</span></code></pre></div>

<p>You’ll now likely want to add the remote <code>origin</code> for your fork:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;$GITHUB_ID&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> -n <span class="s2">&quot;Enter your GitHub ID id: &quot;</span> <span class="p">;</span> <span class="nb">read </span>GITHUB_ID <span class="p">;</span> <span class="k">fi</span>
git remote add origin git@github.com:<span class="k">${</span><span class="nv">GITHUB_ID</span><span class="k">}</span>/brooklyn
git submodule foreach <span class="s1">&#39;git remote add origin git@github.com:${GITHUB_ID}/${name}&#39;</span></code></pre></div>

<p>And if you created the fork in the GitHub UI, you may want to create a remote named by your
GitHub ID as well (if you used <code>hub</code> it will have done it for you):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;$GITHUB_ID&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> -n <span class="s2">&quot;Enter your GitHub ID id: &quot;</span> <span class="p">;</span> <span class="nb">read </span>GITHUB_ID <span class="p">;</span> <span class="k">fi</span>
git remote add <span class="k">${</span><span class="nv">GITHUB_ID</span><span class="k">}</span> git@github.com:<span class="k">${</span><span class="nv">GITHUB_ID</span><span class="k">}</span>/brooklyn
git submodule foreach <span class="s1">&#39;git remote add ${GITHUB_ID} git@github.com:${GITHUB_ID}/${name}&#39;</span></code></pre></div>

<p>You probably also want the default <code>push</code> target to be your repo in the <code>origin</code> remote:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git config remote.pushDefault origin<span class="p">;</span> git submodule foreach <span class="s1">&#39;git config remote.pushDefault origin&#39;</span></code></pre></div>

<p>Optionally, if you’re interested in reviewing pull requests,
you may wish to have <code>git</code> automatically check out PR branches: </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git config --local --add remote.upstream.fetch <span class="s1">&#39;+refs/pull/*/head:refs/remotes/upstream/pr/*&#39;</span>
git submodule foreach <span class="s2">&quot;git config --local --add remote.upstream.fetch &#39;+refs/pull/*/head:refs/remotes/upstream/pr/*&#39;&quot;</span>
git pull <span class="p">;</span> git submodule foreach <span class="s1">&#39;git pull&#39;</span></code></pre></div>

<p>And also optionally, to set up the official Apache repo as a remote —
useful if GitHub is slow to update (and required if you’re a committer):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git remote add apache-git https://git-wip-us.apache.org/repos/asf/brooklyn
git submodule foreach <span class="s1">&#39;git remote add apache-git https://git-wip-us.apache.org/repos/asf/${name}&#39;</span></code></pre></div>

<p><strong>That’s it.</strong> Test that it’s all working by browsing the submodules and issuing <code>git remote -v</code> and <code>git pull</code> commands. Also see the aliases below.</p>

<p>To work on code in a branch, in any of the submodules, you can simply do the following:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">% git branch my-new-feature-branch upstream/master
% git checkout my-new-feature-branch
<span class="o">(</span>make some commits<span class="o">)</span>
% git push
To https://github.com/your_account/brooklyn.git
 * <span class="o">[</span>new branch<span class="o">]</span>      my-new-feature-branch -&gt; my-new-feature-branch</code></pre></div>

<p>Note how the branch is tracking <code>upstream/master</code> for the purpose of <code>git pull</code>, 
but a <code>git push</code> goes to the fork. 
When you’re finished, don’t forget to go to the UI of your repo to open a pull request.</p>

<h2 id="multi-project-changes">Multi-Project Changes</h2>

<p>Cross-project changes will require multiple PRs: 
try to minimise these, especially where one depends on another,
and especially especially where two depend on each other – that is normally a sign of broken backwards compatibility!
Open the PRs in dependency order and assist reviewers by including the URLs of any upstream dependency PRs 
in the dependent PR to help reviewers 
(dependency PRs will then include a “mention” comment of the dependent PR).</p>

<p>For information on reviewing and committing PRs, see <a href="/brooklyn-docs/developers/committers/merging-contributed-code.html">the committer’s guide</a>.</p>

<h2 id="how-we-use-branches">How We Use Branches</h2>

<h3 id="history-tags-and-workflow">History, Tags, and Workflow</h3>

<p>There are branches for each released version and tags for various other milestones.</p>

<p>As described in more detail <a href="git-more.html#how-we-use-branches">here</a>, 
we primarily use submodule remote branch tracking
rather than submodule SHA1 ID’s.</p>

<p>The history prior to <code>0.9.0</code> is imported from the legacy <code>incubator-brooklyn</code> repo for reference and history only.
Visit that repo to build those versions; they are not intended to build here.
(Although this works:
<code>mkdir merged ; for x in brooklyn-* ; do pushd $x ; git checkout 0.8.0-incubating ; cp -r * ../merged ; popd ; cd merged ; mvn clean install</code>.)</p>

<h3 id="tracking-branches">Tracking Branches</h3>

<p>Our submodules track <strong>branches</strong>, rather than specific commits,
although due to the way <code>git</code> works there are still references to specific commits.</p>

<p>We track <code>master</code> for the master branch and the version branch for other official branches, 
starting with <code>0.9.0</code>.
We update the uber-project recorded SHA reference to subprojects on releases but not regularly – 
that just creates noise and is unnecessary with the <code>--remote</code> option on <code>submodule update</code>.
In fact, <code>git submodule update --remote --merge</code> pretty much works well;
the <code>git sup</code> alias (below) makes it even easier.</p>

<p>On the other hand, <code>git status</code> is not very nice in the uber-project:
it will show a “new commits” message for submodules, 
unless you’re exactly at the uber-project’s recorded reference.
Ignore these.
It will tell you if you have uncommitted changes, 
but it’s not very useful for telling whether you’re up to date or if you have newer changes committed 
in the subproject or in your push branch.
If you go in to each sub-project, <code>git status</code> works better, but it can be confusing
to track which branch each subproject is one.
A <code>summary</code> script is provided below which solves these issues,
showing useful status across all subprojects.</p>

<h2 id="about-submodules">About Submodules</h2>

<p>Submodules can be confusing; if you get stuck the info and references in this section may be useful.
You can also work <a href="#not-using-submodules">without submodules</a>.</p>

<h3 id="pitfalls-of-submodules">Pitfalls of Submodules</h3>

<p>Some of the things to be careful of are:</p>

<ul>
  <li>
    <p><strong>Don’t copy submodule directories.</strong> This doesn’t act as you’d expect;
its <code>.git</code> record simply points at the parent project’s <code>.git</code> folder,
which in turn points back at it.  So if you copy it and make changes in the copy,
it’s rather surprising where those changes actually get made.
Worse, <code>git</code> doesn’t report errors; you’ll only notice it when you see files change bizarrely.</p>
  </li>
  <li>
    <p><strong>Be careful committing in the uber-project.</strong>
You can update commit IDs, but if these accidentally point to an ID that isn’t committed, 
everyone else sees errors.
It’s useful to do this on release (and update the target branch then also)
and maybe occasionally at other milestones but so much at other times as these ID’s 
very quickly become stale on <code>master</code>.</p>
  </li>
</ul>

<h3 id="git-submodule-references">Git Submodule References</h3>

<ul>
  <li>[1] <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">Git SCM Book</a></li>
  <li>[2] <a href="https://medium.com/@porteneuve/mastering-git-submodules-34c65e940407#.r7677prhv">Medium blog: Mastering Git Submodules</a></li>
  <li>[3] <code>git submodule --help</code> section on <code>update</code></li>
  <li>[4] <a href="http://stackoverflow.com/questions/1777854/git-submodules-specify-a-branch-tag/18797720#18797720">StackOverflow: Git Submodules Branch Tag</a></li>
</ul>

<h2 id="not-using-submodules">Not Using Submodules</h2>

<p>If you don’t want to use submodules, you can clone everything as top-level projects with the following:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mkdir apache-brooklyn
<span class="nb">cd </span>apache-brooklyn
git clone http://github.com/apache/brooklyn/
git clone http://github.com/apache/brooklyn-ui/
git clone http://github.com/apache/brooklyn-server/
git clone http://github.com/apache/brooklyn-client/
git clone http://github.com/apache/brooklyn-docs/
git clone http://github.com/apache/brooklyn-library/
git clone http://github.com/apache/brooklyn-dist/</code></pre></div>

<p>With one symbolic link in the root <code>apache-brooklyn/</code> dir, you can then use a normal <code>mvn</code> workflow:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ln -s brooklyn/pom.xml .
mvn clean install</code></pre></div>

<p>With minor changes you can follow the instructions for creating forks and getting all updates
elsewhere on this page.</p>

<h2 id="useful-aliases-and-commands">Useful Aliases and Commands</h2>

<p>This sets up variants of <code>pull</code>, <code>diff</code>, and <code>push</code> – called <code>sup</code>, <code>sdiff</code>, and <code>spush</code> – which act across submodules:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># update all modules</span>
git config --global alias.sup <span class="s1">&#39;!git pull &amp;&amp; git submodule update --remote --merge --recursive&#39;</span>
<span class="c"># show diffs across all modules</span>
git config --global alias.sdiff <span class="s1">&#39;!git diff &amp;&amp; git submodule foreach &quot;git diff&quot;&#39;</span>
<span class="c"># return to master in all modules</span>
git config --global alias.smaster <span class="s1">&#39;!git checkout master &amp;&amp; echo &amp;&amp; git submodule foreach &quot;git checkout master &amp;&amp; echo&quot;&#39;</span>
<span class="c"># push in all modules</span>
git config --global alias.spush <span class="s1">&#39;!git push &amp;&amp; git submodule foreach &quot;git push&quot;&#39;</span>
<span class="c"># show issues in all projects (only works if upstream configured properly for current branch)</span>
git config --global alias.si <span class="s1">&#39;!hub issue &amp;&amp; git submodule foreach &quot;hub issue&quot;&#39;</span></code></pre></div>

<h4 id="getting-a-summary-of-submodules">Getting a Summary of Submodules</h4>

<p>The <code>git-summary</code> script <a href="https://github.com/apache/brooklyn-dist/tree/master/scripts">in the brooklyn-dist/scripts</a> makes 
working with submodules much more enjoyable.
Follow the <code>README</code> in that directory to add those scripts to your path, and then set up the following git aliases:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">curl https://gist.githubusercontent.com/ahgittin/6399a29df1229a37b092/raw/208cf4b3ec2ede77297d2f6011821ae62cf9ac0c/git-summary.sh <span class="se">\</span>
  <span class="p">|</span> sudo tee /usr/local/bin/git-summary
sudo chmod <span class="m">755</span> /usr/local/bin/git-summary  
git config --global alias.ss <span class="s1">&#39;!git-summary -r&#39;</span>
git config --global alias.so <span class="s1">&#39;!git-summary -r -o&#39;</span></code></pre></div>

<p>Then <code>git ss</code> will give output such as:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">brooklyn: master &lt;- upstream/master <span class="o">(</span>up to date<span class="o">)</span>

brooklyn-client: master &lt;- upstream/master <span class="o">(</span>up to date<span class="o">)</span>

brooklyn-dist: master &lt;- upstream/master <span class="o">(</span>up to date<span class="o">)</span>

brooklyn-docs: master &lt;- upstream/master <span class="o">(</span>uncommitted changes only<span class="o">)</span>
  M guide/dev/code/submodules.md

brooklyn-library: master &lt;- upstream/master <span class="o">(</span>up to date<span class="o">)</span>

brooklyn-server: master &lt;- upstream/master <span class="o">(</span>up to date<span class="o">)</span>

brooklyn-ui: <span class="nb">test</span> &lt;- origin/test <span class="o">(</span>upstream <span class="m">2</span> ahead of master<span class="o">)</span>
  &gt; 62c553e Alex Heneveld, <span class="m">18</span> minutes ago: WIP 2
  &gt; 22cd0ad Alex Heneveld, <span class="m">62</span> minutes ago: WIP 1
 ?? wip-local-untracked-file</code></pre></div>

<p>The command <code>git so</code> does the same thing without updating remotes.
Use it if you want it to run fast, or if you’re offline.
For more information un <code>git-summary --help</code>.</p>

<h4 id="other-handy-commands">Other Handy Commands</h4>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># run a git command (eg pull) in each submodule</span>
git submodule foreach <span class="s1">&#39;git pull&#39;</span>

<span class="c"># iterate across submodules in bash, e.g. doing git status</span>
<span class="k">for</span> x in brooklyn-* <span class="p">;</span> <span class="k">do</span> <span class="nb">pushd</span> <span class="nv">$x</span> <span class="p">;</span> git status <span class="p">;</span> <span class="nb">popd</span> <span class="p">;</span> <span class="k">done</span></code></pre></div>

<h2 id="legacy-incubator-pull-requests">Legacy Incubator Pull Requests</h2>

<p>If you need to apply code changes made pre-graduation, against the incubator repository,
splitting it up into submodules, it’s fairly straightforward:</p>

<ol>
  <li>In the incubator codebase, start at its final state: <code>cd .../incubator-brooklyn &amp;&amp; git checkout master &amp;&amp; git pull</code></li>
  <li>Make a branch for your merged changes: <code>git checkout -b my-branch-merged-master</code></li>
  <li>Merge or rebase the required commits (resolving conflicts; but don’t worry about commit messages): <code>git merge my-branch</code></li>
  <li>Create a patch file: <code>git diff &gt; /tmp/diff-for-my-branch</code></li>
  <li>Go to the new <code>brooklyn</code> uber-project directory.
Ensure you are at master and all subprojects updated: <code>cd .../brooklyn/ &amp;&amp; git sup</code></li>
  <li>Apply the patch: <code>patch -p1 &lt; /tmp/diff-for-my-branch</code> </li>
  <li>Inspect the changes: <code>git ss</code></li>
  <li>Test it, commit each changed project on a branch and create pull requests.
Where applicable, record the original author(s) and message(s) in the commit.</li>
</ol>


            </div>

            <aside class="col-md-3">
                <div class="list-group side-menu" id="side-menu">



  
     
              
                  <h4 class="">
                    <a href="/brooklyn-docs/developers/index.html" class="list-group-item breadcrumb breadcrumb0">
                      Developers
                      </a></h4>
              
              
                 
                
                  
                  <a href="/brooklyn-docs/developers/code/index.html" class="list-group-item active with-sub-item">Get the Code
                    </a>
                  <div class="sub-item">
                    
                      
                      <a href="index.html" class="list-group-item sub-item " >
                        Basics
                        &nbsp;<span class="octicon octicon-link-external"></span></a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#set-up-forks" class="list-group-item sub-item  section" section-target="#set-up-forks">
                        Set Up Forks
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#multi-project-changes" class="list-group-item sub-item  section" section-target="#multi-project-changes">
                        Multi-Project Changes
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#how-we-use-branches" class="list-group-item sub-item  section" section-target="#how-we-use-branches">
                        Branches
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#about-submodules" class="list-group-item sub-item  section" section-target="#about-submodules">
                        Submodules
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#not-using-submodules" class="list-group-item sub-item  section" section-target="#not-using-submodules">
                        Not Using Submodules
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#useful-aliases-and-commands" class="list-group-item sub-item  section" section-target="#useful-aliases-and-commands">
                        Git Aliases
                        </a>
                    
                      
                      <a href="/brooklyn-docs/developers/code/git-more.html#legacy-incubator-pull-requests" class="list-group-item sub-item  section" section-target="#legacy-incubator-pull-requests">
                        Incubator PRs
                        </a>
                    
                  </div>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/developers/how-to-contribute.html" class="list-group-item">How to Contribute
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/v/latest/dev/index.html" class="list-group-item">Developer Guide
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/developers/committers/index.html" class="list-group-item">Committer Guide
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/developers/code-standards.html" class="list-group-item">Code Standards
                    </a>
                
              
                 
                
                  
                  <a href="/brooklyn-docs/developers/links.html" class="list-group-item">Handy Places
                    </a>
                
              
                 
                
                  
                  <a href="http://github.com/apache/brooklyn" class="list-group-item">GitHub
                    &nbsp;<span class="octicon octicon-link-external"></span></a>
                
              
                 
                
                  
                  <a href="https://issues.apache.org/jira/browse/BROOKLYN" class="list-group-item">Bug Tracker (JIRA)
                    &nbsp;<span class="octicon octicon-link-external"></span></a>
                
              
        
        
  

        
</div>
<div id="width_reference"></div>


<script language="JavaScript" type="application/javascript">
(function($){
    
    sidemenu_x_sizer=function(){ $('#side-menu').width($('#side-menu').parent().find('#width_reference').outerWidth()); };
    $(sidemenu_x_sizer);
    $(window).resize(sidemenu_x_sizer);

    
    sidemenu_y_nonfloater=function(){
      if ($('#side-menu').outerHeight(true) + $('#header').outerHeight(true) + $('#footer').outerHeight(true) > window.innerHeight ||
          $('#side-menu').width() >= $('#content_container').width()/2) {
        $('#side-menu').css('position', 'inherit');
      } else {
        // restore if screen has grown
        $('#side-menu').css('position', 'fixed');
      }
    };
    $(sidemenu_y_nonfloater);
    $(window).resize(sidemenu_y_nonfloater);

    

    var sideMenu = $("#side-menu"),
        sideItems = sideMenu.find("a"),
        // Anchors corresponding to menu items
        scrollItems = sideItems.map(function(){
          var item = $(this).attr("section-target");
          if (item && item.length) { return item; }
        });

    var highlight_section_last_top = -1;
    var highlight_section_completed = false;

    var highlight_section = function() {
       // Get container scroll position
       var highlight_section_new_top = $(this).scrollTop();
       if (highlight_section_new_top == highlight_section_last_top) return;
       var highlight_section_new_bottom = highlight_section_new_top + $(window).height();
       var scroll_advancing = (highlight_section_new_top > highlight_section_last_top);

       var last_item = null, active_item = $("#side-menu a.section#active");

       var found_top = false;
       var displayable_items = scrollItems.map(function(itemI){
         item = $(scrollItems[itemI]);
         if (item && item.length) {
           if (highlight_section_last_top == -1 || !highlight_section_completed) {
             // just opening page - take item matching hash, or otherwise the first item visible
             if (item.selector === window.location.hash || (item.offset().top > highlight_section_new_top - 20 && !found_top)) {
               found_top = true;
               if (item.selector === window.location.hash && item.offset().top < highlight_section_new_top + 60) {
                 // because of our top header, we need to scroll 64px down from any link
                 $('html, body').animate({scrollTop: item.offset().top - 64}, 0);
               }
               return item;
             }
           } else if (scroll_advancing) {
             // if scrolling advance, pick up a section when title starts before 1/3 height
             if (item.offset().top < highlight_section_new_top + $(window).height()/3)
               return item;

             // or if containing div is finished (usu the whole main content)
             div_containing_item = item.closest("div");
             if (div_containing_item.offset().top + div_containing_item.height() < highlight_section_new_bottom + 15)
               return item;
             // or when next title is visible
             if (last_item && item.offset().top < highlight_section_new_bottom + 15)
               return last_item;
           } else {
             // if scrolling back, pick up a section as soon as the title is visible,
             if (item.offset().top < highlight_section_new_top)
               return item;
             // or if title is before the 2/3 point
             // (not sure about this, probably want also to have
             // "AND the id.top is <= displayable_itemsrent_active_it.top" so we don't jump FORWARD a section
             // when scrolling BACK, with lots of tiny sections)
             if ((item.offset().top < highlight_section_new_top + 2*$(window).height()/3)
                 && (!active_item || !active_item.offset() || active_item.offset().top >= item.offset().top))
               return item;

           }
           last_item = item;
         }
       });
       if (!highlight_section_completed && document.readyState === "complete") {
         highlight_section_completed = true;
       }
       if (!displayable_items.length) {
         $("#side-menu a.section").removeClass("active");
       } else {
         displayable_items = displayable_items[displayable_items.length-1];
         var id = displayable_items && displayable_items.length ? displayable_items[0].id : "";
       // Set/remove active class
         new_active = $("#side-menu a.section").filter("[section-target='#"+id+"']");
         if (new_active.hasClass("active")) {
           // nothing needed
         } else {
           $("#side-menu a.section").removeClass("active");
           $("#side-menu a.section").filter("[section-target='#"+id+"']").addClass("active");
         }
       }

       highlight_section_last_top = highlight_section_new_top;
    };
    var highlight_new_section = function() {
      highlight_section_completed = false;
      highlight_section_last_top = -1;
      highlight_section();
    }

    $(window).scroll(highlight_section);
    $(highlight_new_section);

    // detect link change - courtesy http://www.bennadel.com/blog/1520-binding-events-to-non-dom-objects-with-jquery.htm

    // Default to the current location.
    var strLocation = window.location.href;
    var strHash = window.location.hash;
    var strPrevLocation = "";
    var strPrevHash = "";

    // This is how often we will be checkint for
    // changes on the location.
    var intIntervalTime = 100;

    // This method removes the pound from the hash.
    var fnCleanHash = function( strHash ){
        return(
            strHash.substring( 1, strHash.length )
            );
    }

    // This will be the method that we use to check
    // changes in the window location.
    var fnCheckLocation = function(){
        // Check to see if the location has changed.
        if (strLocation != window.location.href){

            // Store the new and previous locations.
            strPrevLocation = strLocation;
            strPrevHash = strHash;
            strLocation = window.location.href;
            strHash = window.location.hash;

            // The location has changed. Trigger a
            // change event on the location object,
            // passing in the current and previous
            // location values.
            $( window.location ).trigger(
                "change",
                {
                    currentHref: strLocation,
                    currentHash: fnCleanHash( strHash ),
                    previousHref: strPrevLocation,
                    previousHash: fnCleanHash( strPrevHash )
                }
                );

        }
    }

    // Set an interval to check the location changes.
    setInterval( fnCheckLocation, intIntervalTime );

    // and trigger highlight section on link change
    $(window.location).bind("change", highlight_new_section);
})(jQuery);

</script>

            </aside>
        </div>
    </div>
</main>

<footer class="container">
    <div class="row">
        <div class="col-md-9">
            <p>Apache Brooklyn is distributed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License v2.0</a>.</p>
        </div>
        <div class="col-md-3 text-right">
            <p>
                <a class="btn btn-sm btn-default" href="https://github.com/apache/brooklyn-docs/edit/master/website/developers/code/git-more.md">Edit This Page</a>
                <a href="https://brooklyn.apache.org/community/how-to-contribute-docs.html"
                    data-toggle="tooltip" data-placement="top" title="" data-delay="400" data-original-title="How to Edit Documentation">
                    <span class="octicon octicon-question octicon-footer"></span>
                </a>
            </p>
        </div>
    </div>
</footer>

</body>

<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/deps/jquery.cookie.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/js/zeroclipboard/ZeroClipboard.min.js"></script>
<script type="text/javascript" src="/brooklyn-docs/style/deps/tooltip.js"></script>

<script type="text/javascript">
    ZeroClipboard.config({ moviePath: '/style/js/zeroclipboard/ZeroClipboard.swf' });
</script>
<script src="/brooklyn-docs/style/js/public.js"></script>
</html>
