<h2 id="single-page-manual--pdf">Single Page Manual &amp; PDF</h2>

<p>A single page overview of selections of the site are available in <code>zoneMergeManual</code> and <code>zoneMergeStarted</code>. These overviews are for the user manual
and getting started guide respectively. The zone merge pages go through the <a href="#site-structure">site structure</a>, described above, and compile the files from this into a
single HTML page.</p>

<p>In order to do this, each page is iterated over in order and it’s rendered content included in the page. The plug-in <code>regex_filter.rb</code> is used to re-write
 &lt;a&gt; links from the structured site into a form which works on a single page. Links are re-written in the following manner:</p>

<ul>
  <li>If the link is from an external domain, leave it as an unaltered link</li>
  <li>If the link is an anchor, convert to the anchor scheme used in the single page</li>
  <li>If the link target is in the single page, change the link to point at the anchor in the single page</li>
  <li>If the link is pointing at somewhere on the brooklyn site which is not included in this single page, point to the website with a specific version, so https://brooklyn.apache.org/v/0.9.0-SNAPSHOT/start/concept-quickstart.html for instance</li>
</ul>

<p>In addition, all images src’s are re-written relative to the root directory.</p>

<p>Pages can be masked from the compilation process by defining a <code>page_mask</code> in the YAML front matter of the zone merge file, then including this mask as <code>true</code> in the child page to exclude.
These pages will then not be included in the compiled single page. Note that this will mask both the child page and any children of this masked page. 
For example <a href="https://github.com/apache/brooklyn-docs/blob/master/zoneMergeStarted.html" target="_blank">zoneMergeStarted</a> uses the mask <code>started-pdf-exclude</code>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Apache Brooklyn Manual</span>
<span class="l-Scalar-Plain">layout</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">singlePage</span>
<span class="l-Scalar-Plain">page_mask</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">started-pdf-exclude</span>
<span class="nn">...</span></code></pre></div>

<p>Then in latter pages, such as <a href="https://github.com/apache/brooklyn-docs/blob/master/guide/ops/index.md" target="_blank">/guide/ops/index.md</a> include <code>started-pdf-exclude: true</code> to
exclude this section from the getting started guide.</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Operations</span>
<span class="l-Scalar-Plain">started-pdf-exclude</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="nn">...</span></code></pre></div>

<p>This will exclude not only the operations page but all of the operations section.</p>

<p>Specific content can be also be masked or unmasked at a page component level by specifying CSS show and hide classes:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">css_hide_class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">usermanual-pdf-exclude</span>
<span class="l-Scalar-Plain">css_show_class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">usermanual-pdf-include</span></code></pre></div>

<p>If the above YAML is included in the front matter of a zone merge file, the classes <code>usermanual-pdf-exclude</code> and <code>usermanual-pdf-include</code> will add or remove a
<code>display: none</code> to a HTML object. In addition the single page theme files <a href="https://github.com/apache/brooklyn-docs/blob/master/_layouts/singlePage.html" target="_blank">singlePage.html</a> and
<a href="https://github.com/apache/brooklyn-docs/blob/master/style/css/singlePage.css">singlePage.css</a> can be used to style only the single merged pages.</p>

<h3 id="conversion-to-pdf">Conversion to PDF</h3>

<p>These single merged pages are then converted to PDF using wkhtmltopdf in the build scripts of this site.</p>
